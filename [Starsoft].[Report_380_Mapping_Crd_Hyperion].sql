USE [Westcon]
GO
/****** Object:  StoredProcedure [Starsoft].[Report_380_Mapping_Crd_Hyperion]    Script Date: 09/12/2016 11:07:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--exec [Starsoft].[Report_380_Mapping_Crd_Hyperion]  1,''
ALTER PROCEDURE [Starsoft].[Report_380_Mapping_Crd_Hyperion]  
	 @CODERP AS INT,
	 @CIA_UKEY AS VARCHAR(20)
AS
BEGIN
	DECLARE @cB18_Ukey as VARCHAR(20)
	DECLARE @ACCOUNT AS VARCHAR(20)=SPACE(20)
		

	-- CALA (2)
	IF (@CodERP = 2) 
		BEGIN 
			SELECT DISTINCT A11_001_C Local, A56_001_C Hyperion
				FROM STARWESTCONCALA2.DBO.A11 (NOLOCK) 
				JOIN STARWESTCONCALA2.DBO.B04 (NOLOCK) ON B04_UKEYP=A11.UKEY
				JOIN STARWESTCONCALA2.DBO.A56 (NOLOCK) ON B04.A56_UKEY=A56.UKEY
				JOIN STARWESTCONCALA2.DBO.WE31  (NOLOCK) ON WE31.A56_UKEY=A56.UKEY  
				JOIN STARWESTCONCALA2.DBO.WE32  (NOLOCK) ON WE32.A11_UKEY=A11.UKEY  
			WHERE A11.CIA_UKEY=@CIA_UKEY  AND A11_005_N=1
			ORDER BY A11_001_C, A56_001_C
		END
	-- MEX (3)
	IF (@CodERP = 3) 
		BEGIN 
			SELECT DISTINCT A11_001_C Local, A56_001_C Hyperion
				FROM STARWESTCONMX.DBO.A11 (NOLOCK) 
				JOIN STARWESTCONMX.DBO.B04 (NOLOCK) ON B04_UKEYP=A11.UKEY
				JOIN STARWESTCONMX.DBO.A56 (NOLOCK) ON B04.A56_UKEY=A56.UKEY
				JOIN STARWESTCONMX.DBO.WE31  (NOLOCK) ON WE31.A56_UKEY=A56.UKEY  
				JOIN STARWESTCONMX.DBO.WE32  (NOLOCK) ON WE32.A11_UKEY=A11.UKEY  
			WHERE  A11_005_N=1
			ORDER BY A11_001_C, A56_001_C
		END
	-- BR (1)
	IF (@CodERP = 1) 
		BEGIN 
			SELECT DISTINCT A11_001_C Local, A56_001_C Hyperion
				FROM STARWESTCONCALA2.DBO.B19 (NOLOCK) 
				JOIN STARWESTCON.DBO.WE31  (NOLOCK) ON WE31.B19_UKEY=B19.UKEY  
				JOIN STARWESTCON.DBO.WE32  (NOLOCK) ON WE32.B19_UKEY=B19.UKEY  
				JOIN STARWESTCON.DBO.A11 (NOLOCK) ON WE32.A11_UKEY=A11.UKEY
				JOIN STARWESTCON.DBO.A56 (NOLOCK) ON WE31.A56_UKEY=A56.UKEY
			WHERE  A11_005_N=1
			ORDER BY A11_001_C, A56_001_C
		END

END