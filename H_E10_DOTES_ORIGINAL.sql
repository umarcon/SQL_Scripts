SELECT * FROM UDA (NOLOCK) WHERE UKEY = 'H_E10_DOTES'

SELECT 
      		SUM(CASE WHEN A28.A28_001_C LIKE '1%'  THEN E11_003_B ELSE 0 END ) AS VALR_COMPRA_DEVOL_TRANSF,
      		SUM(CASE WHEN A28.A28_001_C LIKE '2%'  THEN E11_003_B ELSE 0 END ) AS VALR_COMPRA_FORA_EST,
      		SUM(CASE WHEN A28.A28_001_C LIKE '3%'  THEN E11_003_B ELSE 0 END ) AS VALR_COMPRA_EXTERIOR,
      		(SELECT TOP 1 D15_005_B 
			FROM STAR_DATA@D15  
			INNER JOIN STAR_DATA@D04 (NOLOCK) ON D15.D04_UKEY = D04.UKEY
			INNER JOIN STAR_DATA@T05 (NOLOCK) ON T05.UKEY=D04.T05_UKEY
			WHERE   NOT T05.ARRAY_051 IN  (4, 5, 11, 12) AND D15_001_D <= ?VPA_SEEK[1] ORDER BY D15_001_D DESC) AS SALDO_INICIAL,
      		(SELECT TOP 1 D15_005_B 
			FROM STAR_DATA@D15  
 			INNER JOIN STAR_DATA@D04 (NOLOCK) ON D15.D04_UKEY = D04.UKEY
    			INNER JOIN STAR_DATA@T05 (NOLOCK) ON T05.UKEY=D04.T05_UKEY
 			WHERE   NOT T05.ARRAY_051 IN  (4, 5, 11, 12) AND D15_001_D BETWEEN ?VPA_SEEK[1] AND ?VPA_SEEK[2]  ORDER BY D15_001_D DESC) AS SALDO_FINAL
      		
         	FROM STAR_DATA#E10 (NOLOCK) 
         	 INNER JOIN STAR_DATA#E11 (NOLOCK) ON E11.E10_UKEY = E10.UKEY
         	 INNER JOIN STAR_DATA#D04 (NOLOCK) ON E11.D04_UKEY = D04.UKEY
              INNER JOIN STAR_DATA#T05 (NOLOCK) ON T05.UKEY=D04.T05_UKEY
              INNER JOIN STAR_DATA#A28 (NOLOCK) ON   A28.UKEY=E11.A28_UKEY

		WHERE  <CIA.FILTER><TABLE>E10</TABLE><ALIAS>E10</ALIAS><PREFIX></PREFIX><SUFFIX> AND </SUFFIX></CIA.FILTER> NOT T05.ARRAY_051 IN  (4, 5, 11, 12)  AND E10_003_D BETWEEN ?VPA_SEEK[1] AND ?VPA_SEEK[2] AND E10_032_N=0