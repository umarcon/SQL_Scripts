-- =============================================
-- Create date: 2016-12-20 - Usmarcon
-- SCRUM-15582
-- Description:	Mapa de Re-Facturaciones
-- =============================================
--EXEC [STARSOFT].[REPORT_390_1] 2,3
ALTER PROCEDURE [Starsoft].[Report_390_1]
	@CodErp int,
	@Division int

AS
BEGIN
	IF @CodErp = 2 -- CALA
		BEGIN
			SELECT 
				'CALA' AS 'CodErp',
				(CASE WHEN @Division = 0 THEN 'TODAS' ELSE (SELECT NOMEDIVISAO FROM TBLDIVISAO WHERE CodERP = @CodErp AND CodDivisao = @Division) END ) AS 'Division',
				J10_001_CDEV AS 'Credit Note',
				J10_003_DDEV AS 'Credit Note Date', 
				J10_001_CORI AS 'Original Invoice',
				J10_003_DORI AS 'Original Invoice Date',
				OV AS 'Sales Order',
				Item AS 'Item Code',
				Description AS 'Item Description',
				(TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) AS 'Qty',
				Value AS 'Unit Value'
				FROM
				(SELECT 
					J10_DEV.J10_001_C AS J10_001_CDEV,
					J10_DEV.J10_003_D AS J10_003_DDEV,
					J10_ORI.J10_001_C AS J10_001_CORI,
					J10_ORI.J10_003_D AS J10_003_DORI,
					J07.J07_001_C AS OV,
					D04.D04_001_C AS Item,
					D04.D04_008_C AS Description,
					J11_DEV.J11_003_B AS QTDE,
					J11_DEV.J11_005_B AS Value,
					J11_DEV.UKEY,
					J10_ORI.CIA_UKEY AS CIA
					FROM STARWESTCONCALA2.DBO.J10 J10_ORI (NOLOCK)
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_ORI (NOLOCK) ON A03_ORI.UKEY = J10_ORI.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_ORI (NOLOCK) ON J11_ORI.J10_UKEY  = J10_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_ORI (NOLOCK) ON J11_ORI.T04_UKEY  = T04_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_ORI (NOLOCK) ON J06_ORI.J06_UKEYP = J10_ORI.UKEY AND J06_ORI.ARRAY_241 = 1
						  LEFT JOIN STARWESTCONCALA2.DBO.J08 (NOLOCK) ON J11_ORI.J11_UKEYP = J08.UKEY
						  LEFT JOIN StarWestconCALA2.DBO.J07 (NOLOCK) ON J08.J07_UKEY = J07.UKEY

						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_DEV (NOLOCK) ON J11_DEV.J11_UKEYP = J11_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J10 J10_DEV (NOLOCK) ON J11_DEV.J10_UKEY  = J10_DEV.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_DEV (NOLOCK) ON A03_DEV.UKEY = J10_DEV.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_DEV (NOLOCK) ON J11_DEV.T04_UKEY  = T04_DEV.UKEY AND T04_DEV.T04_506_N = 1
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_DEV (NOLOCK) ON J06_DEV.J06_UKEYP = J10_DEV.UKEY AND J06_DEV.ARRAY_241 = 1
						  INNER JOIN STARWESTCONCALA2.DBO.D04 (NOLOCK) ON J11_DEV.D04_UKEY = D04.UKEY
				)TMP		  
				LEFT JOIN STARWESTCONCALA2.DBO.J11 J11_REF (NOLOCK) ON TMP.UKEY      = J11_REF.J11_UKEYJ11
				LEFT JOIN STARWESTCONCALA2.DBO.J10 J10_REF (NOLOCK) ON J11_REF.J10_UKEY  = J10_REF.UKEY
				LEFT JOIN STARWESTCONCALA2.DBO.A03 A03_REF (NOLOCK) ON A03_REF.UKEY = J10_REF.J10_UKEYP
				LEFT JOIN STARWESTCONCALA2.DBO.T04 T04_REF (NOLOCK) ON J11_REF.T04_UKEY  = T04_REF.UKEY AND T04_REF.T04_506_N = 1
				LEFT JOIN STARWESTCONCALA2.DBO.J06 J06_REF (NOLOCK) ON J06_REF.J06_UKEYP = J10_REF.UKEY AND J06_REF.ARRAY_241 = 1
				WHERE (TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) > 0 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))
				ORDER BY 
					  TMP.J10_003_DORI
		END

	IF @CodErp = 3 -- MEXICO
		BEGIN
			SELECT 
				'MEXICO' AS 'CodErp',
				(CASE WHEN @Division = 0 THEN 'TODAS' ELSE (SELECT NOMEDIVISAO FROM TBLDIVISAO WHERE CodERP = @CodErp AND CodDivisao = @Division) END ) AS 'Division',
				J10_001_CDEV AS 'Credit Note',
				J10_003_DDEV AS 'Credit Note Date', 
				J10_001_CORI AS 'Original Invoice',
				J10_003_DORI AS 'Original Invoice Date',
				OV AS 'Sales Order',
				Item AS 'Item Code',
				Description AS 'Item Description',
				(TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) AS 'Qty',
				Value AS 'Unit Value'
				FROM
				(SELECT 
					J10_DEV.J10_001_C AS J10_001_CDEV,
					J10_DEV.J10_003_D AS J10_003_DDEV,
					J10_ORI.J10_001_C AS J10_001_CORI,
					J10_ORI.J10_003_D AS J10_003_DORI,
					J07.J07_001_C AS OV,
					D04.D04_001_C AS Item,
					D04.D04_008_C AS Description,
					J11_DEV.J11_003_B AS QTDE,
					J11_DEV.J11_005_B AS Value,
					J11_DEV.UKEY,
					J10_ORI.CIA_UKEY AS CIA
					FROM STARWESTCONMX.DBO.J10 J10_ORI (NOLOCK)
						  INNER JOIN STARWESTCONMX.DBO.A03 A03_ORI (NOLOCK) ON A03_ORI.UKEY = J10_ORI.J10_UKEYP
						  INNER JOIN STARWESTCONMX.DBO.J11 J11_ORI (NOLOCK) ON J11_ORI.J10_UKEY  = J10_ORI.UKEY
						  INNER JOIN STARWESTCONMX.DBO.T04 T04_ORI (NOLOCK) ON J11_ORI.T04_UKEY  = T04_ORI.UKEY
						  INNER JOIN STARWESTCONMX.DBO.J06 J06_ORI (NOLOCK) ON J06_ORI.J06_UKEYP = J10_ORI.UKEY AND J06_ORI.ARRAY_241 = 1
						  LEFT JOIN STARWESTCONMX.DBO.J08 (NOLOCK) ON J11_ORI.J11_UKEYP = J08.UKEY
						  LEFT JOIN StarWestconMX.DBO.J07 (NOLOCK) ON J08.J07_UKEY = J07.UKEY

						  INNER JOIN STARWESTCONMX.DBO.J11 J11_DEV (NOLOCK) ON J11_DEV.J11_UKEYP = J11_ORI.UKEY
						  INNER JOIN STARWESTCONMX.DBO.J10 J10_DEV (NOLOCK) ON J11_DEV.J10_UKEY  = J10_DEV.UKEY
						  INNER JOIN STARWESTCONMX.DBO.A03 A03_DEV (NOLOCK) ON A03_DEV.UKEY = J10_DEV.J10_UKEYP
						  INNER JOIN STARWESTCONMX.DBO.T04 T04_DEV (NOLOCK) ON J11_DEV.T04_UKEY  = T04_DEV.UKEY AND T04_DEV.T04_506_N = 1
						  INNER JOIN STARWESTCONMX.DBO.J06 J06_DEV (NOLOCK) ON J06_DEV.J06_UKEYP = J10_DEV.UKEY AND J06_DEV.ARRAY_241 = 1
						  INNER JOIN STARWESTCONMX.DBO.D04 (NOLOCK) ON J11_DEV.D04_UKEY = D04.UKEY
				)TMP		  
				LEFT JOIN STARWESTCONMX.DBO.J11 J11_REF (NOLOCK) ON TMP.UKEY      = J11_REF.J11_UKEYJ11
				LEFT JOIN STARWESTCONMX.DBO.J10 J10_REF (NOLOCK) ON J11_REF.J10_UKEY  = J10_REF.UKEY
				LEFT JOIN STARWESTCONMX.DBO.A03 A03_REF (NOLOCK) ON A03_REF.UKEY = J10_REF.J10_UKEYP
				LEFT JOIN STARWESTCONMX.DBO.T04 T04_REF (NOLOCK) ON J11_REF.T04_UKEY  = T04_REF.UKEY AND T04_REF.T04_506_N = 1
				LEFT JOIN STARWESTCONMX.DBO.J06 J06_REF (NOLOCK) ON J06_REF.J06_UKEYP = J10_REF.UKEY AND J06_REF.ARRAY_241 = 1
				WHERE (TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) > 0 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))
				ORDER BY 
					  TMP.J10_003_DORI
		END

	IF @CodErp = 4 -- COLOMBIA
		BEGIN
			SELECT 
				'COLOMBIA' AS 'CodErp',
				(CASE WHEN @Division = 0 THEN 'TODAS' ELSE (SELECT NOMEDIVISAO FROM TBLDIVISAO WHERE CodERP = @CodErp AND CodDivisao = @Division) END ) AS 'Division',
				J10_001_CDEV AS 'Credit Note',
				J10_003_DDEV AS 'Credit Note Date', 
				J10_001_CORI AS 'Original Invoice',
				J10_003_DORI AS 'Original Invoice Date',
				OV AS 'Sales Order',
				Item AS 'Item Code',
				Description AS 'Item Description',
				(TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) AS 'Qty',
				Value AS 'Unit Value'
				FROM
				(SELECT 
					J10_DEV.J10_001_C AS J10_001_CDEV,
					J10_DEV.J10_003_D AS J10_003_DDEV,
					J10_ORI.J10_001_C AS J10_001_CORI,
					J10_ORI.J10_003_D AS J10_003_DORI,
					J07.J07_001_C AS OV,
					D04.D04_001_C AS Item,
					D04.D04_008_C AS Description,
					J11_DEV.J11_003_B AS QTDE,
					J11_DEV.J11_005_B AS Value,
					J11_DEV.UKEY,
					J10_ORI.CIA_UKEY AS CIA
					FROM STARWESTCONCALA2.DBO.J10 J10_ORI (NOLOCK)
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_ORI (NOLOCK) ON A03_ORI.UKEY = J10_ORI.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_ORI (NOLOCK) ON J11_ORI.J10_UKEY  = J10_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_ORI (NOLOCK) ON J11_ORI.T04_UKEY  = T04_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_ORI (NOLOCK) ON J06_ORI.J06_UKEYP = J10_ORI.UKEY AND J06_ORI.ARRAY_241 = 1
						  LEFT JOIN STARWESTCONCALA2.DBO.J08 (NOLOCK) ON J11_ORI.J11_UKEYP = J08.UKEY
						  LEFT JOIN StarWestconCALA2.DBO.J07 (NOLOCK) ON J08.J07_UKEY = J07.UKEY

						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_DEV (NOLOCK) ON J11_DEV.J11_UKEYP = J11_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J10 J10_DEV (NOLOCK) ON J11_DEV.J10_UKEY  = J10_DEV.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_DEV (NOLOCK) ON A03_DEV.UKEY = J10_DEV.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_DEV (NOLOCK) ON J11_DEV.T04_UKEY  = T04_DEV.UKEY AND T04_DEV.T04_506_N = 1
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_DEV (NOLOCK) ON J06_DEV.J06_UKEYP = J10_DEV.UKEY AND J06_DEV.ARRAY_241 = 1
						  INNER JOIN STARWESTCONCALA2.DBO.D04 (NOLOCK) ON J11_DEV.D04_UKEY = D04.UKEY
				)TMP		  
				LEFT JOIN STARWESTCONCALA2.DBO.J11 J11_REF (NOLOCK) ON TMP.UKEY      = J11_REF.J11_UKEYJ11
				LEFT JOIN STARWESTCONCALA2.DBO.J10 J10_REF (NOLOCK) ON J11_REF.J10_UKEY  = J10_REF.UKEY
				LEFT JOIN STARWESTCONCALA2.DBO.A03 A03_REF (NOLOCK) ON A03_REF.UKEY = J10_REF.J10_UKEYP
				LEFT JOIN STARWESTCONCALA2.DBO.T04 T04_REF (NOLOCK) ON J11_REF.T04_UKEY  = T04_REF.UKEY AND T04_REF.T04_506_N = 1
				LEFT JOIN STARWESTCONCALA2.DBO.J06 J06_REF (NOLOCK) ON J06_REF.J06_UKEYP = J10_REF.UKEY AND J06_REF.ARRAY_241 = 1
				WHERE (TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) > 0 AND 
				((@Division = 0 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))) OR 
				(@Division = 7 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))) OR
				(@Division = 8 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))))
				ORDER BY 
					  TMP.J10_003_DORI
		END
		
	IF @CodErp = 5 -- PERU
		BEGIN
			SELECT 
				'PERU' AS 'CodErp',
				(CASE WHEN @Division = 0 THEN 'TODAS' ELSE (SELECT NOMEDIVISAO FROM TBLDIVISAO WHERE CodERP = @CodErp AND CodDivisao = @Division) END ) AS 'Division',
				J10_001_CDEV AS 'Credit Note',
				J10_003_DDEV AS 'Credit Note Date', 
				J10_001_CORI AS 'Original Invoice',
				J10_003_DORI AS 'Original Invoice Date',
				OV AS 'Sales Order',
				Item AS 'Item Code',
				Description AS 'Item Description',
				(TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) AS 'Qty',
				Value AS 'Unit Value'
				FROM
				(SELECT 
					J10_DEV.J10_001_C AS J10_001_CDEV,
					J10_DEV.J10_003_D AS J10_003_DDEV,
					J10_ORI.J10_001_C AS J10_001_CORI,
					J10_ORI.J10_003_D AS J10_003_DORI,
					J07.J07_001_C AS OV,
					D04.D04_001_C AS Item,
					D04.D04_008_C AS Description,
					J11_DEV.J11_003_B AS QTDE,
					J11_DEV.J11_005_B AS Value,
					J11_DEV.UKEY,
					J10_ORI.CIA_UKEY AS CIA
					FROM STARWESTCONCALA2.DBO.J10 J10_ORI (NOLOCK)
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_ORI (NOLOCK) ON A03_ORI.UKEY = J10_ORI.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_ORI (NOLOCK) ON J11_ORI.J10_UKEY  = J10_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_ORI (NOLOCK) ON J11_ORI.T04_UKEY  = T04_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_ORI (NOLOCK) ON J06_ORI.J06_UKEYP = J10_ORI.UKEY AND J06_ORI.ARRAY_241 = 1
						  LEFT JOIN STARWESTCONCALA2.DBO.J08 (NOLOCK) ON J11_ORI.J11_UKEYP = J08.UKEY
						  LEFT JOIN StarWestconCALA2.DBO.J07 (NOLOCK) ON J08.J07_UKEY = J07.UKEY

						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_DEV (NOLOCK) ON J11_DEV.J11_UKEYP = J11_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J10 J10_DEV (NOLOCK) ON J11_DEV.J10_UKEY  = J10_DEV.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_DEV (NOLOCK) ON A03_DEV.UKEY = J10_DEV.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_DEV (NOLOCK) ON J11_DEV.T04_UKEY  = T04_DEV.UKEY AND T04_DEV.T04_506_N = 1
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_DEV (NOLOCK) ON J06_DEV.J06_UKEYP = J10_DEV.UKEY AND J06_DEV.ARRAY_241 = 1
						  INNER JOIN STARWESTCONCALA2.DBO.D04 (NOLOCK) ON J11_DEV.D04_UKEY = D04.UKEY
				)TMP		  
				LEFT JOIN STARWESTCONCALA2.DBO.J11 J11_REF (NOLOCK) ON TMP.UKEY      = J11_REF.J11_UKEYJ11
				LEFT JOIN STARWESTCONCALA2.DBO.J10 J10_REF (NOLOCK) ON J11_REF.J10_UKEY  = J10_REF.UKEY
				LEFT JOIN STARWESTCONCALA2.DBO.A03 A03_REF (NOLOCK) ON A03_REF.UKEY = J10_REF.J10_UKEYP
				LEFT JOIN STARWESTCONCALA2.DBO.T04 T04_REF (NOLOCK) ON J11_REF.T04_UKEY  = T04_REF.UKEY AND T04_REF.T04_506_N = 1
				LEFT JOIN STARWESTCONCALA2.DBO.J06 J06_REF (NOLOCK) ON J06_REF.J06_UKEYP = J10_REF.UKEY AND J06_REF.ARRAY_241 = 1
				WHERE (TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) > 0 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))
				ORDER BY 
					  TMP.J10_003_DORI
		END

	IF @CodErp = 6 -- EQUADOR
		BEGIN
			SELECT 
				'EQUADOR' AS 'CodErp',
				(CASE WHEN @Division = 0 THEN 'TODAS' ELSE (SELECT NOMEDIVISAO FROM TBLDIVISAO WHERE CodERP = @CodErp AND CodDivisao = @Division) END ) AS 'Division',
				J10_001_CDEV AS 'Credit Note',
				J10_003_DDEV AS 'Credit Note Date', 
				J10_001_CORI AS 'Original Invoice',
				J10_003_DORI AS 'Original Invoice Date',
				OV AS 'Sales Order',
				Item AS 'Item Code',
				Description AS 'Item Description',
				(TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) AS 'Qty',
				Value AS 'Unit Value'
				FROM
				(SELECT 
					J10_DEV.J10_001_C AS J10_001_CDEV,
					J10_DEV.J10_003_D AS J10_003_DDEV,
					J10_ORI.J10_001_C AS J10_001_CORI,
					J10_ORI.J10_003_D AS J10_003_DORI,
					J07.J07_001_C AS OV,
					D04.D04_001_C AS Item,
					D04.D04_008_C AS Description,
					J11_DEV.J11_003_B AS QTDE,
					J11_DEV.J11_005_B AS Value,
					J11_DEV.UKEY,
					J10_ORI.CIA_UKEY AS CIA
					FROM STARWESTCONCALA2.DBO.J10 J10_ORI (NOLOCK)
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_ORI (NOLOCK) ON A03_ORI.UKEY = J10_ORI.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_ORI (NOLOCK) ON J11_ORI.J10_UKEY  = J10_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_ORI (NOLOCK) ON J11_ORI.T04_UKEY  = T04_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_ORI (NOLOCK) ON J06_ORI.J06_UKEYP = J10_ORI.UKEY AND J06_ORI.ARRAY_241 = 1
						  LEFT JOIN STARWESTCONCALA2.DBO.J08 (NOLOCK) ON J11_ORI.J11_UKEYP = J08.UKEY
						  LEFT JOIN StarWestconCALA2.DBO.J07 (NOLOCK) ON J08.J07_UKEY = J07.UKEY

						  INNER JOIN STARWESTCONCALA2.DBO.J11 J11_DEV (NOLOCK) ON J11_DEV.J11_UKEYP = J11_ORI.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.J10 J10_DEV (NOLOCK) ON J11_DEV.J10_UKEY  = J10_DEV.UKEY
						  INNER JOIN STARWESTCONCALA2.DBO.A03 A03_DEV (NOLOCK) ON A03_DEV.UKEY = J10_DEV.J10_UKEYP
						  INNER JOIN STARWESTCONCALA2.DBO.T04 T04_DEV (NOLOCK) ON J11_DEV.T04_UKEY  = T04_DEV.UKEY AND T04_DEV.T04_506_N = 1
						  INNER JOIN STARWESTCONCALA2.DBO.J06 J06_DEV (NOLOCK) ON J06_DEV.J06_UKEYP = J10_DEV.UKEY AND J06_DEV.ARRAY_241 = 1
						  INNER JOIN STARWESTCONCALA2.DBO.D04 (NOLOCK) ON J11_DEV.D04_UKEY = D04.UKEY
				)TMP		  
				LEFT JOIN STARWESTCONCALA2.DBO.J11 J11_REF (NOLOCK) ON TMP.UKEY      = J11_REF.J11_UKEYJ11
				LEFT JOIN STARWESTCONCALA2.DBO.J10 J10_REF (NOLOCK) ON J11_REF.J10_UKEY  = J10_REF.UKEY
				LEFT JOIN STARWESTCONCALA2.DBO.A03 A03_REF (NOLOCK) ON A03_REF.UKEY = J10_REF.J10_UKEYP
				LEFT JOIN STARWESTCONCALA2.DBO.T04 T04_REF (NOLOCK) ON J11_REF.T04_UKEY  = T04_REF.UKEY AND T04_REF.T04_506_N = 1
				LEFT JOIN STARWESTCONCALA2.DBO.J06 J06_REF (NOLOCK) ON J06_REF.J06_UKEYP = J10_REF.UKEY AND J06_REF.ARRAY_241 = 1
				WHERE (TMP.QTDE-ISNULL(J11_REF.J11_003_B,0)) > 0 AND TMP.CIA IN (SELECT CIA_UKEY FROM intranet.CiaUkey(@CodErp, @Division))
				ORDER BY 
					  TMP.J10_003_DORI
		END
END

