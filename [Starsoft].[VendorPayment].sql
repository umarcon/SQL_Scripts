USE [Westcon]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
--exec [Starsoft].[VendorPayment]  4,'00000001'

ALTER PROCEDURE [Starsoft].[VendorPayment] 
@CodERP as int,
@CodVendor as varchar(20)

as 

IF @CODERP = 1
	BEGIN
		SELECT ISNULL(A13_001_C,'') AS CONDICAO, ISNULL(A13_003_C,'') AS CODCONDICAO FROM STARWESTCON.DBO.A08 (NOLOCK) LEFT JOIN STARWESTCON.DBO.A13 (NOLOCK) ON A08.A13_UKEY = A13.UKEY WHERE A08_001_C = @CODVENDOR
	END

IF @CODERP = 2
	BEGIN
		SELECT ISNULL(A13_001_C,'') AS CONDICAO, ISNULL(A13_003_C,'') AS CODCONDICAO FROM STARWESTCONCALA2.DBO.A08 (NOLOCK) LEFT JOIN STARWESTCONCALA2.DBO.A13 (NOLOCK) ON A08.A13_UKEY = A13.UKEY WHERE A08_001_C = @CODVENDOR AND A08.CIA_UKEY = 'STAR_'
	END

IF @CODERP = 3
	BEGIN
		SELECT ISNULL(A13_001_C,'') AS CONDICAO, ISNULL(A13_003_C,'') AS CODCONDICAO FROM STARWESTCONMX.DBO.A08 (NOLOCK) LEFT JOIN STARWESTCONMX.DBO.A13 (NOLOCK) ON A08.A13_UKEY = A13.UKEY WHERE A08_001_C = @CODVENDOR
	END

IF @CODERP = 4
	BEGIN
		SELECT ISNULL(A13_001_C,'') AS CONDICAO, ISNULL(A13_003_C,'') AS CODCONDICAO FROM STARWESTCONCALA2.DBO.A08 (NOLOCK) LEFT JOIN STARWESTCONCALA2.DBO.A13 (NOLOCK) ON A08.A13_UKEY = A13.UKEY WHERE A08_001_C = @CODVENDOR AND A08.CIA_UKEY IN ('M8530','M8531')
	END

IF @CODERP = 5
	BEGIN
		SELECT ISNULL(A13_001_C,'') AS CONDICAO, ISNULL(A13_003_C,'') AS CODCONDICAO FROM STARWESTCONCALA2.DBO.A08 (NOLOCK) LEFT JOIN STARWESTCONCALA2.DBO.A13 (NOLOCK) ON A08.A13_UKEY = A13.UKEY WHERE A08_001_C = @CODVENDOR AND A08.CIA_UKEY = 'P6SIH'
	END